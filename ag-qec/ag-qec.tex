% !TEX TS-program = pdflatex
% Reproducibility update: auto-append detailed methods, runtime, and checklist appendices.

\documentclass[conference]{IEEEtran}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{tikz}
\usepackage[ruled,vlined]{algorithm2e}
\usetikzlibrary{positioning}
\begin{document}
\title{Asymmetry-Aware Algebraic-Geometry CSS Codes with Degeneracy-Aware Belief Propagation for Hollow-Core Fiber Coexistence}
\author{\IEEEauthorblockN{Da Xu \\ China Mobile Research Institute}}
\maketitle
\begin{abstract}
Hollow-core fibers (HCFs) offer ultra-low nonlinearity and latency for quantum-secured backhaul, yet co-propagating classical channels inject asymmetric, sometimes bursty noise that degrades entanglement. We introduce two innovations for this regime:
(i) an \textbf{asymmetry-aware AG-CSS co-design} that tunes $(d_X,d_Z)$ to measured $(p_X,p_Z)$ from a physics-calibrated HCF model; and
(ii) a \textbf{degeneracy-aware, reweighted min-sum BP} with \emph{syndrome-space damping} that reduces harmful short-cycle effects while exploiting stabilizer degeneracy.
We evaluate an explicit $[[255,33,21]]$ AG-inspired CSS instance over a 100~km HCF with a 10~dBm classical channel using an SpRS/FWM-based noise model with Markov correlations.
Monte Carlo shows block-error $\hat P_L \approx 5.0\times10^{-4}$ with a two-sided Wilson 95\% CI of $\pm 2.0\times10^{-4}$, i.e., $F_e\approx 0.9995\pm0.0002$, and we translate this to near-asymptotic key rates with finite-size penalties negligible at $N\!\sim\!10^6$.
We provide a deterministic matrix generator and containerized scripts to reproduce these results.
The approach yields higher fidelity at comparable rate and sub-\,$\mu$s decoding latency estimates versus surface/BCH baselines under identical channel assumptions.
\end{abstract}

\section{Background and Channel Model}\label{sec:background}
\subsection{Hollow-Core Fiber Coexistence Noise}
We first give a physics-calibrated model: with HCF attenuation $\alpha$ (dB/km), classical launch power $P_{\rm dBm}$, wavelength separation $\Delta\lambda$, and calibration $(\gamma_R,\gamma_F)$, the effective power is $P_{\rm eff}=P_0 e^{-0.1\alpha L}$ and
$p_Z \approx 1-\exp[-(\gamma_R P_{\rm eff} L+\gamma_F P_{\rm eff}^2\Delta\lambda)]$, $p_X=\eta\,p_Z$, $p_Y=\tfrac{1}{2}(p_X+p_Z)$.
For fair comparison we also report results under an i.i.d. depolarizing channel at $p=0.03$ (100~km, 10~dBm), consistent with coexistence reports.
\begin{remark}[On model limitations and asymmetry]
A realistic evaluation should sweep $p$, \emph{explicit asymmetry} $(p_Z,p_X)$ and correlations $\rho$, and consider co-optimizing fiber/channel parameters together with $(d_X,d_Z)$.
\end{remark}

\subsection{Degeneracy-Aware, Reweighted BP Decoder}\label{sec:implementation}
In the present work we implement a \emph{reweighted min-sum} variant with \textbf{syndrome-space damping}: check updates are scaled by $\beta\!\in\!(0,1)$ and VN extrinsics by $\lambda\!\in\!(0,1)$; after convergence we map to a minimum-weight coset representative using the stabilizer group (\emph{degeneracy-aware post-processing}).
This reduces small-cycle amplification and leverages degeneracy without OSDâ€™s heavy cost.

\begin{algorithm}[t]
\caption{Degeneracy-aware, reweighted min-sum BP (for $Z$ errors; $X$ similar)}\label{algo:dabp}
\KwIn{Syndrome $s$, log-likelihood ratios $L$, Tanner graph $(N(i),N(j))$}
\KwOut{Estimated error $\hat e$}
initialise $E_j^{(0)} \gets L_j$\;
\For{$t=0$ \KwTo $T-1$}{
  \For{each check node $i$}{
    \For{each variable node $j\in N(i)$}{
      $M_{i\to j}^{(t+1)} \gets \beta\cdot \operatorname{sgn}\!\Big(\prod_{j' \in N(i)\setminus j} E_{j'}^{(t)}\Big)\cdot \min_{j' \in N(i)\setminus j} |E_{j'}^{(t)}|$\;
    }
  }
  \For{each variable node $j$}{
    $E_j^{(t+1)} \gets L_j + \lambda\sum_{i \in N(j)} M_{i\to j}^{(t+1)}$\;
  }
  $\hat e^{(t)} \gets \mathbb{1}[E^{(t+1)}<0]$\;
  \If{$H\hat e^{(t)} = s$}{\Return $\hat e^{(t)}$}
}
\tcp{Degeneracy-aware coset selection}
$\hat e^{(t)} \leftarrow \arg\min_{g\in \langle S\rangle} \mathrm{wt}(\hat e^{(t)}\oplus g)$\;
\textbf{Output} $\hat{e}^{(t)}$ \;\tcp*{best guess if maximum iterations reached}
\end{algorithm}

\begin{table*}[t]
\centering
\caption{Comparison vs. surface/BCH baselines over 100~km HCF coexistence channel.}
\begin{tabular}{lllllll}
\toprule
Code & Params & Rate & $P_L$ & $F_e$ & Latency (est.) & Decoder \\
\midrule
Surface code & $d=3$ & 0.111 & $1.1\times 10^{-3}$ & $0.9989$ & $5.2~\mu$s & MWPM (CPU) \\
BCH (255,131,15) & $[[255,23]]$ & 0.090 & $8.0\times 10^{-4}$ & $0.9992$ & $2.1~\mu$s & Berlekamp--Massey \\
\textbf{AG-inspired code (ours)} & $[[255,33,21]]$ & 0.129 & $(5.0\pm 2.0)\times 10^{-4}$ & $0.9995\pm 0.0002$ & $0.32~\mu\text{s}$ & BP (FPGA est., DA-RMS) \\
\bottomrule
\end{tabular}
\end{table*}

\section{Methodology Enhancements and Simulation Results}\label{sec:enhancements}
\subsection{Physics\textendash driven noise model}
In our default runs we choose $(\gamma_{\mathrm{R}},\gamma_{\mathrm{F}})\!=\!(0.11,10^{-4})$ and $\alpha\!=\!0.3$\,dB/km to reproduce $p\!\approx\!3\%$ at $(L,P_{\rm dBm},\Delta\lambda)\!=\!(100,10,5)$.
\subsection{Unified benchmarking and reproducibility}
We release a runnable example (\texttt{simulation.py}) for asymmetric/correlated noise and block-error MC with Wilson CIs, and a deterministic CSS matrix generator (\texttt{generate\_matrices.py}) that produces $H_X,H_Z$ satisfying $H_XH_Z^\top\!=\!0$ for public benchmarking (matrices live under \texttt{matrices/}).

% ===== Auto-included appendices (guarded so the paper builds without artifacts) =====
% Methods details: construction, noise model, decoder/OSD, CSV schema, and ablations
\IfFileExists{appendix_methods.tex}{\input{appendix_methods}}{}

% Runtime + complexity (BP iterations, OSD-2 cost, per-block timings, machine info)
\IfFileExists{appendix_runtime.tex}{\input{appendix_runtime}}{}

% Reproducibility checklist and one-command build
\IfFileExists{appendix_reproducibility.tex}{\input{appendix_reproducibility}}{}

% Optional figures produced by 'make figs'
\IfFileExists{figs/ablation.pdf}{%
  \begin{figure}[h]\centering\includegraphics[width=.95\linewidth]{figs/ablation}\caption{BP vs.\ BP+OSD-2 across $(p_X,p_Z,\eta)$ sweeps. Included only if generated.}\end{figure}}{}
\IfFileExists{figs/complexity.pdf}{%
  \begin{figure}[h]\centering\includegraphics[width=.95\linewidth]{figs/complexity}\caption{Per-block runtime (BP and OSD-2) vs.\ SNR; 95\% Wilson CIs shown as whiskers.}\end{figure}}{}
\end{document}
